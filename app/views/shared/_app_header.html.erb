<%# app/views/shared/_app_header.html.erb %>

<header class="app-header">
  <div class="app-header-content">
    <%# Logo + App Name - aligné à gauche %>
    <div class="app-brand">
      <div class="app-logo">
        <svg width="28" height="28" viewBox="0 0 32 32" fill="none">
          <!-- Logo minimal: un cercle avec une vague -->
          <circle cx="16" cy="16" r="14" fill="<%= @logo_color || '#C4937A' %>"/>
          <path d="M8 18C10 16 14 16 16 18C18 20 22 20 24 18"
                stroke="white"
                stroke-width="2"
                stroke-linecap="round"/>
        </svg>
      </div>

      <div class="app-name">
        <span>Space for me</span>
      </div>
    </div>

    <%# Menu hamburger à droite %>
    <div class="app-menu" data-controller="dropdown">
      <button class="menu-toggle"
              data-action="click->dropdown#toggle click@window->dropdown#hide"
              data-dropdown-target="trigger">
        <i class="fas fa-ellipsis-v"></i>
      </button>

      <div class="dropdown-menu" data-dropdown-target="menu">
        <div class="dropdown-header">
          <div class="user-info">
            <div class="user-avatar">
              <%= user_avatar_text %>
            </div>
            <div class="user-details">
              <strong><%= user_display_name %></strong>
              <% if user_signed_in? %>
                <small><%= current_user.email %></small>
              <% end %>
            </div>
          </div>
        </div>

        <div class="dropdown-divider"></div>

        <!-- partial -->
        <%= render "shared/user_menu" %>

        <% if user_signed_in? %>
          <div class="dropdown-divider"></div>
          <%= link_to destroy_user_session_path,
                      data: { turbo_method: :delete },
                      class: "dropdown-item logout-item" do %>
            <i class="fas fa-sign-out-alt"></i>
            <span>Déconnexion</span>
          <% end %>
        <% end %>
      </div>
    </div>
  </div>
</header>
