<%# app/views/users/profile.html.erb %>

<div class="profile-container">
  <!-- Back button -->
  <div class="btn-back">
    <%= link_to dashboard_path, class: "btn-link border-0 ps-2" do %>
      <i class="fas fa-arrow-left me-2"></i>
      Dashboard
    <% end %>
  </div>

  <!-- User Info Card -->
  <div class="profile-card profile-header-card">
    <div class="profile-avatar">
      <i class="fas fa-user"></i>
    </div>
    <div class="profile-header-info">
      <h1 class="profile-name"><%= @user.first_name %> <%= @user.last_name %></h1>
      <p class="profile-email"><%= @user.email %></p>
    </div>
  </div>

  <!-- Personal Info Card -->
  <div class="profile-card">
    <div class="profile-section-header">
      <i class="fas fa-id-card"></i>
      <h2>Informations personnelles</h2>
    </div>

    <div class="profile-info-grid">
      <% if @user.gender.present? %>
        <div class="profile-info-item">
          <span class="profile-info-label">Genre</span>
          <span class="profile-info-value"><%= @user.gender %></span>
        </div>
      <% end %>

      <% if @user.birth_sex.present? %>
        <div class="profile-info-item">
          <span class="profile-info-label">Sexe de naissance</span>
          <span class="profile-info-value"><%= @user.birth_sex %></span>
        </div>
      <% end %>

      <% if @user.date_of_birth.present? %>
        <div class="profile-info-item">
          <span class="profile-info-label">Date de naissance</span>
          <span class="profile-info-value"><%= l(@user.date_of_birth, format: :long) %></span>
        </div>
      <% end %>
    </div>
  </div>

  <%# Collect active treatments %>
  <% treatments = [] %>
  <% treatments << "Androtardyl" if @user.treatment_androtardyl %>
  <% treatments << "Nebido" if @user.treatment_nebido %>
  <% treatments << "Bicalutamide" if @user.treatment_bicalutamide %>
  <% treatments << "Decapeptyl" if @user.treatment_decapeptyl %>
  <% treatments << "Lupron" if @user.treatment_lupron %>
  <% treatments << "Progestérone" if @user.treatment_progesterone %>
  <% treatments << "Estreva (gel)" if @user.treatment_estreva %>
  <% treatments << "Oestrodose (gel)" if @user.treatment_oestrodose %>
  <% treatments << "Oesclim (patch)" if @user.treatment_oesclim %>
  <% treatments << "Dermestril (patch)" if @user.treatment_dermestril %>
  <% treatments << "Provames" if @user.treatment_provames %>
  <% treatments << "Estrofem" if @user.treatment_estrofem %>
  <% treatments << "Progynova" if @user.treatment_progynova %>
  <% treatments << "Neofollin (injection)" if @user.treatment_neofollin %>
  <% treatments << "Gynodian Depot (injection)" if @user.treatment_gynodian %>

  <% if treatments.any? %>
    <!-- Treatments Card -->
    <div class="profile-card">
      <div class="profile-section-header">
        <i class="fas fa-pills"></i>
        <h2>Traitements hormonaux</h2>
        <span class="profile-count-badge"><%= treatments.count %></span>
      </div>

      <div class="profile-tags">
        <% treatments.each do |treatment| %>
          <span class="profile-tag profile-tag--treatment">
            <i class="fas fa-check me-1"></i>
            <%= treatment %>
          </span>
        <% end %>
      </div>
    </div>
  <% end %>

  <%# Collect active operations/procedures %>
  <% operations = [] %>
  <% operations << "Torsoplastie" if @user.operation_torsoplastie %>
  <% operations << "Phalloplastie" if @user.operation_phalloplastie %>
  <% operations << "Métaidoïoplastie" if @user.operation_metaiodoplastie %>
  <% operations << "Hystérectomie" if @user.operation_hysterectomie %>
  <% operations << "Exercices vocaux (M)" if @user.exercices_voix_m %>
  <% operations << "Sport" if @user.sport %>
  <% operations << "FFS (Fronto-orbital)" if @user.operation_fronto_orbital_contouring %>
  <% operations << "Rhinoplastie" if @user.operation_rhinoplastie %>
  <% operations << "Génioplastie" if @user.operation_genioplastie %>
  <% operations << "Tracheal shave" if @user.operation_tracheal_shave %>
  <% operations << "Glottoplastie" if @user.operation_glottoplastie %>
  <% operations << "Vaginoplastie" if @user.operation_vaginoplastie %>
  <% operations << "Labiaplastie" if @user.operation_labiaplastie %>
  <% operations << "Orchiectomie" if @user.operation_orchiectomie %>
  <% operations << "Liposculpture féminisante" if @user.operation_liposculpture_feminisante %>
  <% operations << "BBL" if @user.operation_bbl %>
  <% operations << "Exercices vocaux (F)" if @user.exercices_voix_f %>
  <% operations << "Épilation laser" if @user.epilation_laser %>

  <% if operations.any? %>
    <!-- Operations Card -->
    <div class="profile-card">
      <div class="profile-section-header">
        <i class="fas fa-hospital"></i>
        <h2>Opérations / Procédures</h2>
        <span class="profile-count-badge"><%= operations.count %></span>
      </div>

      <div class="profile-tags">
        <% operations.each do |operation| %>
          <span class="profile-tag profile-tag--operation">
            <i class="fas fa-check me-1"></i>
            <%= operation %>
          </span>
        <% end %>
      </div>
    </div>
  <% end %>

  <!-- Edit Button -->
  <div class="profile-actions">
    <%= link_to edit_user_registration_path, class: "profile-edit-btn" do %>
      <i class="fas fa-pen me-2"></i>
      Modifier mon profil
    <% end %>
  </div>
</div>
